<div *ngIf="surveyId">
  <div class="card mt-5">
    <!-- Card Header -->
    <div class="card-header d-flex w-100">
      <div class="mr-auto d-flex flex-row w-50">
        <span class="w-25">Page {{page?.orderNo}} of {{pageSize}}</span>
      </div>
      <div class="btn-group" role="group">
        <button *ngIf="!isEditPage" type="button" class="btn btn-outline-primary" tooltip="Edit page name and description" (click)="onEditPageClick(page?.id)">
          <i class="fas fa-pencil-alt"></i>
        </button>
        <button *ngIf="isEditPage" type="button" class="btn btn-outline-primary" tooltip="Save page name and description" (click)="isEditPage = false">
          <i class="fas fa-save"></i>
        </button>
        <button type="button" class="btn btn-outline-primary" tooltip="Move Down" (click)="movePageDown(page?.id)" [disabled]="page?.orderNo === pageSize">
          <i class="fas fa-chevron-down"></i>
        </button>
        <button type="button" class="btn btn-outline-primary" tooltip="Move Up" (click)="movePageUp(page?.id)" [disabled]="page?.orderNo === 1">
          <i class="fas fa-chevron-up"></i>
        </button>
        <button type="button" class="btn btn-outline-primary" tooltip="Remove Page" (click)="removePage(page?.id)">
          <i class="fas fa-trash-alt"></i>
        </button>
      </div>
    </div>
    <!-- #/Card Header -->

    <!-- Card Body -->
    <div class="card-body bg-white">
      <!-- Edit Page Name and Description Form -->
      <form *ngIf="isEditPage" class="mb-5 mt-2">
        <div class="form-group">
          <label [for]="'page-name-input-' + page?.id">Edit Page Name</label>
          <input
            [id]="'page-name-input-' + page?.id"
            name="page-name-input"
            type="text"
            class="form-control w-100"
            placeholder="Enter page name"
            [ngModel]="page?.name"
          >
        </div>
        <div class="form-group">
          <label [for]="'page-description-input-' + page?.id">Edit Page Description</label>
          <input
            [id]="'page-description-input-' + page?.id"
            name="page-description-input"
            type="text"
            class="form-control w-100"
            placeholder="Enter page description"
            [ngModel]="page?.description"
          >
        </div>
      </form>
      <!-- #/Edit Page Name and Description Form -->

      <!-- Page Name and Description -->
      <div *ngIf="!isEditPage && (page?.name || page?.description)" class="d-flex flex-column mb-3 mt-2">
        <div *ngIf="page?.name">
          <label>Page Name</label>
          <h4>{{page?.name}}</h4>
        </div>
        <div *ngIf="page?.description">
          <label>Page Description</label>
          <h4>{{page?.description}}</h4>
        </div>
      </div>
      <!-- #/Page Name and Description -->

      <!-- Question Builder Container -->
      <div cdkDropList [cdkDropListData]="elements" #pageElements="cdkDropList" (cdkDropListDropped)="drop($event)">
        <div *ngFor="let item of elements | mapValues; trackBy: trackElement" [ngClass]="item.value.orderNo !== elementsSize ? 'mb-5' : ''" cdkDrag>
          <!-- Drag and Drop Background Place Holder -->
          <div class="drag-drop-placeholder-question" *cdkDragPlaceholder></div>
          <!-- #/Drag and Drop Background Place Holder -->
          <div id="question-builder-container" class="d-flex flex-row align-content-start" [ngClass]="!isSavedMap.get(item.key) ? 'z-depth-1' : ''">
            <!-- Move Option Button -->
            <span class="mr-3 mb-3">
              <button [ngClass]="isSavedMap.get(item.key) || elements.size === 1 ? 'd-none' : ''" type="button" class="btn btn-outline-secondary" tooltip="Drag and Drop Question" cdkDragHandle>
                <i class="fas fa-arrows-alt"></i>
              </button>
            </span>
            <!-- #/Move Option Button -->

            <!-- Question Builder Container -->
            <sb-question-builder-container
              class="w-100"
              [element]="item?.value"
              [elementsSize]="elementsSize"
              [pageId]="page?.id"
              [surveyId]="surveyId"
              (isSavedEvent)="handleIsSavedEvent($event)"
            ></sb-question-builder-container>
            <!-- #/Question Builder Container -->
          </div>
        </div>
      </div>
      <!-- #/Question Builder Container -->
    </div>
    <!-- #/Card Body -->

    <!-- Card Footer -->
    <div class="card-footer d-flex w-100">
      <div class="mr-auto">
        <div class="input-group">
          <div class="input-group-prepend">
            <button type="button" class="btn btn-outline-primary" (click)="addElement(page?.id)">Add Element</button>
            <button type="button" class="btn btn-outline-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="sr-only">Toggle Drop-down</span>
            </button>
            <div class="dropdown-menu">
              <a class="dropdown-item" (click)="addElement(page?.id)">
                <i class="fas fa-question"></i>
                <span class="ml-2">Question</span>
              </a>
              <a class="dropdown-item">
                <i class="fas fa-paragraph"></i>
                <span class="ml-2">Paragraph</span>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="d-flex flex-row" *ngIf="pageSize > 1">
        <!-- Navigate to page selection -->
        <div>
          <select
            id="pageNavNext"
            name="pageNavNext"
            class="form-control"
            [(ngModel)]="pageNavNext"
            (ngModelChange)="handlePageNavNext($event)">
            <option value="goToNextPage" selected>Continue to next page</option>
            <option *ngFor="let itemTwo of pages$ | mapValues; trackBy:trackElement" [value]="itemTwo.key" [disabled]="itemTwo?.key === page?.id">
              <span id="page-orderNo" *ngIf="itemTwo.value.orderNo">Go to page {{itemTwo.value.orderNo}}</span>
              <span id="page-title" *ngIf="itemTwo.value.title">| {{itemTwo.value.title}}</span>
            </option>
          </select>
        </div>
        <!-- #/Navigate to page selection -->

        <!-- Insert Page -->
        <button type="button" class="btn btn-outline-primary ml-4" tooltip="Insert Page" (click)="insertPage(page?.id)">
          <i class="fas fa-plus"></i>
        </button>
        <!-- #/Add Page -->
      </div>
    </div>
    <!-- #/Card Footer -->
  </div>
</div>
